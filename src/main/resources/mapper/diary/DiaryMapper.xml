<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.crewstation.mapper.diary.DiaryMapper">
    <select id="selectDiaryList">
        select
            vpd.id as id,
            vpd.post_title as title,
            vpd.created_datetime as createdDatetime,
            vpd.updated_datetime as updatedDatetime,
            vpd.diary_like_count as diaryLikeCount,
            vpd.diary_reply_count as diaryReplyCount,
            vfmf.file_origin_name as fileOriginName,
            vfmf.file_name as fileName,
            vfmf.file_path as filePath,
            vfmf.member_id as memberId,
            cd.crew_id as crewId,
            cd.diary_id as diaryId,
            vfpsf.file_id as fileId,
            vfpsf.post_section_id as postSectionId,
            tl.post_id as postId,
            tc.crew_name as crewName

        from view_post_diary vpd
                join view_file_member_file vfmf on vpd.id = vfmf.member_id
                join view_file_post_section_file vfpsf on vpd.id = vfpsf.post_section_id
                join tbl_crew_diary cd on vpd.id = cd.diary_id
                join tbl_like tl on vpd.id = tl.post_id
                join tbl_crew tc on vpd.id = tc.id

        where vpd.diary_secret = 'public'
        order by vpd.created_datetime desc
    </select>
</mapper>